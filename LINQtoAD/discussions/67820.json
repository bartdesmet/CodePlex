[
  {
    "Id": "230500",
    "ThreadId": "67820",
    "Html": "<p>Hi All!&nbsp; I'm hoping someone can help me out.&nbsp; I have it all hooked up and am querying (rather quickly I might add...thanks for this Bart!) but I am running into an odd behavior when querying by objectGuid.</p>\r\n<p><strong>Query:<br></strong><span style=\"color:Blue\">var</span> q = (<span style=\"color:Blue\">from</span> u <span style=\"color:Blue\">in</span> ctx.Users<br>&nbsp;&nbsp;&nbsp;<span style=\"color:Blue\">where</span> (u.Name == <span style=\"color:#A31515\">&quot;Jane Doe&quot;</span>)&nbsp;<br>&nbsp;&nbsp;&nbsp;<span style=\"color:Blue\">select</span> <span style=\"color:Blue\">new</span> { ID = u.Id });<br><strong>Result:<br></strong>(&amp;(objectClass=userProxyFull)(Name=Jane Doe))<br>objectGuid:&nbsp;&nbsp;&nbsp;&nbsp; ab671b0b-8fc8-42af-bf63-abb23a9d7424<br>Match:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; True&nbsp;&nbsp;&nbsp;&nbsp; &lt;---- All I am doing here is u.ID == new Guid(&quot;ab671b0b-8fc8-42af-bf63-abb23a9d7424&quot;) to double check</p>\r\n<p><strong>Query:<br></strong><span style=\"color:Blue\">var</span> q = (<span style=\"color:Blue\">from</span> u <span style=\"color:Blue\">in</span> ctx.Users<br>&nbsp; <span style=\"color:Blue\">where</span> u.Id == <span style=\"color:Blue\">new</span> Guid(<span style=\"color:#A31515\">&quot;AB671B0B-8FC8-42AF-BF63-ABB23A9D7424&quot;</span>)<br>&nbsp; <span style=\"color:Blue\">select</span> <span style=\"color:Blue\">new</span> { ID = u.Id });<br><strong>Result:<br></strong>(&amp;(objectClass=userProxyFull)(objectGUID=ab671b0b-8fc8-42af-bf63-abb23a9d7424))</p>\r\n<p>Just wondering why the second query doesn't return a result, I know it is a valid GUID cause it was just returned in the query above when I searched by name which also means the property name is correct (objectGUID).&nbsp; I would expect that it would return the Jane Doe user again because I have her GUID and am filtering by that GUID...</p>\r\n<p>Anyone have any idea why this might be???</p>\r\n<p>Thanks,</p>\r\n<p>Mike</p>",
    "PostedDate": "2009-09-02T21:52:20.63-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "246582",
    "ThreadId": "67820",
    "Html": "<p>I ended up figuring out what the problem was...</p>\r\n<p>After reading this post: <a href=\"http://kjellsj.blogspot.com/2005/03/get-ad-objects-by-guid-using.html\">http://kjellsj.blogspot.com/2005/03/get-ad-objects-by-guid-using.html</a></p>\r\n<p>Figured out that the Search Filter will not work with the code found here:</p>\r\n<p>DirectorySource.cs<br>Around Line 907: GetCondition(BinaryExpression e)<br><span style=\"color:#000000\"><span style=\"font-size:x-small\">Around Line 942: val = val.ToString().Replace(</span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;(&quot;</span></span><span style=\"font-size:x-small\">, </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;0x28&quot;</span></span><span style=\"font-size:x-small\">).Replace(</span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;)&quot;</span></span><span style=\"font-size:x-small\">, </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;0x29&quot;</span></span><span style=\"font-size:x-small\">).Replace(</span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">@&quot;\\&quot;</span></span><span style=\"font-size:x-small\">, </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;0x5c&quot;</span></span><span style=\"font-size:x-small\">);</span></span></p>\r\n<p><span style=\"color:#000000\">String Guid: B0C670E5-F05A-4748-8F4E-E8567126DD96<br>Binary Guid: </span><span style=\"color:#000000\">E5-70-C6-B0-5A-F0-48-47-8F-4E-E8-56-71-26-DD-96<br>Search Filter: (objectGUID=\\E5\\70\\C6\\B0\\5A\\F0\\48\\47\\8F\\4E\\E8\\56\\71\\26\\DD\\96)</span></p>\r\n<p><span style=\"color:#000000\">The search filter was being changed to this:</span></p>\r\n<p><span style=\"color:#000000\">(objectGUID=0x5cE50x5c700x5cC60x5cB00x5c5A0x5cF00x5c480x5c470x5c8F0x5c4E0x5cE80x5c560x5c710x5c260x5cDD0x5c96)</span></p>\r\n<p><span style=\"color:#000000\">So I used the code in the link above to create the guid as an octet string:</span></p>\r\n<p><span style=\"color:#000000\">\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">string</span> Guid2OctetString(<span style=\"color:Blue\">string</span> objectGuid) { \r\n  System.Guid guid = <span style=\"color:Blue\">new</span> Guid(objectGuid); \r\n  <span style=\"color:Blue\">byte</span>[] byteGuid = guid.ToByteArray(); \r\n  <span style=\"color:Blue\">string</span> queryGuid = <span style=\"color:#A31515\">&quot;&quot;</span>; \r\n  <span style=\"color:Blue\">foreach</span>(<span style=\"color:Blue\">byte</span> b <span style=\"color:Blue\">in</span> byteGuid) { \r\n    queryGuid += <span style=\"color:#A31515\">@&quot;\\&quot;</span> + b.ToString(<span style=\"color:#A31515\">&quot;x2&quot;</span>); \r\n  } \r\n  <span style=\"color:Blue\">return</span> queryGuid; \r\n}\r\n</pre>\r\n</div>\r\n<p>...and then placed an if/then to detect when I am searching for an objectGuid in the DirectorySource.cs file so that it will leave the &quot;\\&quot; in the search filter when appropriate.</p>\r\n<p>Hope this helps someone else...</p>\r\n<p>&nbsp;</p>\r\n<p>Mike</p>\r\n</span></p>",
    "PostedDate": "2009-10-16T08:15:01.487-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]