[
  {
    "Id": "635072",
    "ThreadId": "263325",
    "Html": "\r\n<p>Just wondering if anyone has tried to upgrade this project and use it with the 4.0 framework?</p>\r\n<p>I am using this project to wrap my AD, and calling it using a WCF service. It works beautifully in the 4.0 framework, except it seems to have issues bringing back values that are DateTime data types. All other data types seem to work without issues.</p>\r\n<p>My code is simple:</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;Dim ROOT As New System.DirectoryServices.DirectoryEntry(&quot;<a href=\"\">LDAP://xxxxx</a>&quot;, &quot;xxxxx&quot;, &quot;xxxxx&quot;)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Dim users As New DirectorySource(Of ADLinq.User)(ROOT, SearchScope.Subtree)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Dim res = From usr In users Where usr.Name.StartsWith(searchcriteria)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Dim dt As DataTable = HelperFunctions.GetBlankTable(GetType(ADLinq.User))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Dim dr As DataRow<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;For Each u In res<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dr = dt.NewRow()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HelperFunctions.AddRow(dr, u)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt.Rows.Add(dr)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Next<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Dim ds As New DataSet()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;ds.Tables.Add(dt)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Return ds</p>\r\n<p>The issue occurs in the class DirectorySource.cs, in the function AssignResultProperty. For a data type of DateTime (In my case PasswordLastChanged) when it attempts to get the PropertyInfo from the helper object, the variable 'p' is null, and it crashes\r\n on a nullreferenceexception.</p>\r\n<p>The line it crashes on is line 496 of DirectorySource.cs. p is null so there for it crashes.</p>\r\n<p>All other datatypes, it works perfectly, except for DateTime.</p>\r\n<p>Interestingly enough, when&nbsp;I create an Identical service using the 3.5 framework, these issues do not seem to occur. Which tends to lean me towards one of the two references that have changed being the culprit. System.DirectoryServices, or System.Data,\r\n however I am not sure.</p>\r\n<p>Was just wondering if anyone has also discovered this issue, or am I totally alone on this one? And if you have figured it out, how did you do so?</p>\r\n<p>Thanks in Advance,</p>\r\n<p>Jason Schatz</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-06-29T15:25:44.94-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]