<div class="wikidoc"><h1>SharePointDataSource&lt;T&gt;</h1>
The SharePointDataSource&lt;T&gt; class acts as the gateway to a SharePoint list in order to write LINQ queries against it. The generic parameter T should reference an entity type generated by <a href="https://linqtosharepoint.codeplex.com/wikipage?title=SPMetal&referringTitle=SharePointDataSource">SpMetal</a>.<br />
<h2>Constructors</h2>
Three constructors are available on SharePointDataSource&lt;T&gt;:<br /><br /><pre>
public SharePointDataSource(Uri siteUrl);
public SharePointDataSource(SPList list);
public SharePointDataSource(SPSite site);
</pre>
<ul><li>The first constructor is used to connect to a SharePoint list using the <b>SharePoint web services</b> where <i>siteUrl</i> points to the SharePoint web site root. The name of the list is retrieved from the <b>List</b> property on the entity <b>ListAttribute</b>. Credentials can be set using the <b>Credentials</b> properties as explained further on.</li>
<li>The second constructor is used to connect to a SharePoint list directly using the <b>SharePoint object model</b>. This will only work if you run the code on the machine hosting the SharePoint list.</li>
<li>The third constructor is used to connect to a SharePoint list directly using the <b>SharePoint object model</b>; the SPList object will be retrieved from the site&#39;s root web automatically using the <b>Path</b> property of the <b>ListAttribute</b>. This will only work if you run the code on the machine hosting the SharePoint list.</li></ul>

<h2>Configuration properties</h2>
SharePointDataSource&lt;T&gt; has three properties you can set to configure the data providers:
<ul><li><b>Log</b> can be set to a System.IO.TextWriter object in order to log diagnostic information about the CAML query sent to the server when executing a query. Logging will be triggered when results are fetched, i.e. whenever iteration is performed on the data source (e.g. using foreach).</li>
<li><b>Credentials</b> can only be used if the data source is connecting to the SharePoint list over web services. It&#39;s used to specify the credentials used for authentication with the web service. If not set, the DefaultNetworkCredentials from the System.Net.CredentialCache will be used.</li>
<li><b>CheckListVersion</b>, if set to true, enforces a list version check whenever the SharePoint list is queried. Such a version check can be used to make sure queries are only executed against a list if it matches the version number kept on the entity type using the <b>ListAttribute</b>&#39;s <b>Version</b> property. Needless use of this feature will affect performance negatively.</li></ul>

<h2>Methods</h2>
All methods except for <b>Dispose</b> on the SharePointDataSource&lt;T&gt; are implementations of IQuerable&lt;T&gt; methods and are not intended to be used directly from your application.<br /><br />As a best practice, it&#39;s recommended to use SharePointDataSource&lt;T&gt; objects in combination with the <b>using</b> statement:<br /><br /><pre>
using (var users = new SharePointDataSource&lt;User&gt;())
{
   //write queries here
}
</pre></div><div class="ClearBoth"></div>